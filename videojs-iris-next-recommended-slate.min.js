/*! @name videojs-iris-next-recommended-slate @version 0.0.0 @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsIrisNextRecommendedSlate=t(e.videojs)}(this,(function(e){"use strict";const t=e.getPlugin("plugin"),i={};class n extends t{constructor(t,n){super(t),this.listUpNextRecommendedVideos=[],this.mutationObserverConfig={attributes:!0,attributeFilter:["class"]},this.observer=new MutationObserver(this.upNextElementChanged.bind(this)),this.options=e.mergeOptions(i,n);const s=this;this.player.ready((()=>{this.player.on("playing",(()=>{setTimeout((function(){const e=s.player.el().querySelector('[id$="end-next-slate"]');s.addCustomElement(s),s.observer.observe(e,s.mutationObserverConfig)}),1e3),this.playAnimation(this.player)})),this.player.on("ended",(()=>{this.inactivePlayButton(this),this.observer.disconnect()})),this.player.on("pause",(()=>{this.pauseAnimation(this.player)})),window.addEventListener("iris_watch",(function(e){s.listUpNextRecommendedVideos=e.detail}))}))}upNextElementChanged(e){const t=this;e.forEach((e=>{"attributes"===e.type&&"class"===e.attributeName&&e.target.id.includes("end-next-slate")&&e.target.className.includes("show")&&(this.updateDuration(t),this.activePlayButton(t))}))}addCustomElement(e){e.player.el().querySelector('[id="btnNzmeIrisPlay"]')||e.addPlayButton(e);e.player.el().querySelector('[id="lbNzmeVideoDuration"]')||e.addDurationLabel(e)}addPlayButton(e){const t=e.player.el().querySelector(".iris-slate-text-container");t&&t.appendChild(e.initPlayButton(e.player).cloneNode(!0))}addDurationLabel(e){const t=e.player.el().querySelector('[id$="end-next-slate-image"]');t&&t.appendChild(e.initDurationLabel(e.player).cloneNode(!0))}playAnimation(e){const t=e.el().querySelector('[id="btnNzmeIrisPlay"]');t&&"nzme-iris-play-button active"===t.className&&(e.el().querySelector('[id="btnNzmeIrisPlayProgress"]').style.animationPlayState="running")}pauseAnimation(e){const t=e.el().querySelector('[id="btnNzmeIrisPlay"]');t&&"nzme-iris-play-button active"===t.className&&(e.el().querySelector('[id="btnNzmeIrisPlayProgress"]').style.animationPlayState="paused")}updateDuration(e){const t=e.getCurrentAsset(e);t&&e.player.catalog.getVideo(t.platform_id,(function(t,i){if(!t||404!=t.status&&403!=t.status){const t=e.player.el().querySelector('[id="lbNzmeVideoDuration"]');t&&(t.innerHTML=i.duration)}else console.log("Video Not Found, skipping asset")}))}activePlayButton(e){e.updateClassesForPlayButton(e,"nzme-iris-play-button active")}inactivePlayButton(e){e.updateClassesForPlayButton(e,"nzme-iris-play-button")}updateClassesForPlayButton(e,t){const i=e.player.el().querySelector('[id="btnNzmeIrisPlay"]');i&&(i.className=t)}getCurrentAsset(e){if(!e.listUpNextRecommendedVideos.length)return null;const t=e.player.el().querySelector('[id$="end-next-slate-title"]');let i;for(let n=0;n<e.listUpNextRecommendedVideos.length;n++){const s=e.listUpNextRecommendedVideos[n];if(s.title===t.textContent){i=s;break}}return i}initPlayButton(){const e=document.createElement("div");e.id="btnNzmeIrisPlay",e.className="nzme-iris-play-button";const t=document.createElement("div");t.className="btn",t.innerHTML='<svg width="10" height="14" viewBox="0 0 10 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 12.6142C0 13.0115 0.441073 13.2501 0.773625 13.0326L9.35997 7.41849C9.6618 7.22114 9.6618 6.77888 9.35996 6.58152L0.773624 0.967379C0.441072 0.749941 0 0.988536 0 1.38586V12.6142Z" fill="white"/>\n    </svg><span>Play</span>',e.appendChild(t);const i=document.createElement("div");return i.id="btnNzmeIrisPlayProgress",i.className="progress",e.appendChild(i),e}initDurationLabel(){const e=document.createElement("label");return e.id="lbNzmeVideoDuration",e.className="nzme-iris-video-duration-label",e}}return n.defaultState={},n.VERSION="0.0.0",e.registerPlugin("irisNextRecommendedSlate",n),n}));
